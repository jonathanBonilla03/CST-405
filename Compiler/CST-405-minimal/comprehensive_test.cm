/*
 * Comprehensive C-Minus Test File
 * CST-405 Compiler Design
 *
 * This file tests ALL features of the C-Minus language:
 * - Global and local variables
 * - Scalar and array variables
 * - All arithmetic operators (+, -, *, /)
 * - All relational operators (<, <=, >, >=, ==, !=)
 * - If-else statements (simple and nested)
 * - While loops (simple and nested)
 * - Function declarations and calls
 * - Parameters (scalar and array)
 * - Return statements
 * - Recursion
 * - Array indexing
 * - Complex expressions
 * - Operator precedence
 * - Built-in functions: input() and print()
 */

/* ========================================
   NO GLOBAL VARIABLE DECLARATIONS
   ======================================== */

/* ========================================
   ARITHMETIC OPERATIONS TESTING
   ======================================== */

int testArithmetic(int a, int b) {
    int sum;
    int diff;
    int prod;
    int quot;
    int complex;

    /* Test all four basic operations */
    sum = a + b;
    diff = a - b;
    prod = a * b;
    quot = a / b;

    /* Test operator precedence: should be 2 + (3 * 4) = 14 */
    complex = 2 + 3 * 4;

    /* Test with parentheses: should be (2 + 3) * 4 = 20 */
    complex = (2 + 3) * 4;

    /* Complex expression */
    complex = a * b + a / b - a + b;

    return sum + diff + prod + quot;
}

/* ========================================
   RELATIONAL OPERATIONS TESTING
   ======================================== */

int testRelational(int x, int y) {
    int result;

    result = 0;

    /* Test less than */
    if (x < y) {
        result = result + 1;
    }

    /* Test less than or equal */
    if (x <= y) {
        result = result + 10;
    }

    /* Test greater than */
    if (x > y) {
        result = result + 100;
    }

    /* Test greater than or equal */
    if (x >= y) {
        result = result + 1000;
    }

    /* Test equality */
    if (x == y) {
        result = result + 10000;
    }

    /* Test inequality */
    if (x != y) {
        result = result + 100000;
    }

    return result;
}

/* ========================================
   IF-ELSE STATEMENT TESTING
   ======================================== */

int testIfElse(int value) {
    int result;

    /* Simple if statement */
    if (value > 0) {
        result = 1;
    }

    /* If-else statement */
    if (value < 0) {
        result = -1;
    } else {
        result = 0;
    }

    /* Nested if-else */
    if (value > 100) {
        if (value > 200) {
            result = 200;
        } else {
            result = 100;
        }
    } else {
        if (value > 50) {
            result = 50;
        } else {
            result = 0;
        }
    }

    return result;
}

/* ========================================
   WHILE LOOP TESTING
   ======================================== */

int testWhileLoop(int n) {
    int sum;
    int i;

    sum = 0;
    i = 1;

    /* Simple while loop - sum from 1 to n */
    while (i <= n) {
        sum = sum + i;
        i = i + 1;
    }

    return sum;
}

/* ========================================
   NESTED LOOPS TESTING
   ======================================== */

int testNestedLoops(int rows, int cols) {
    int total;
    int i;
    int j;

    total = 0;
    i = 0;

    /* Nested while loops */
    while (i < rows) {
        j = 0;
        while (j < cols) {
            total = total + 1;
            j = j + 1;
        }
        i = i + 1;
    }

    return total;
}

/* ========================================
   ARRAY OPERATIONS TESTING
   ======================================== */

void testArrayOperations(int arr[], int size) {
    int i;

    /* Initialize array */
    i = 0;
    while (i < size) {
        arr[i] = i * 2;
        i = i + 1;
    }

    /* Modify array elements */
    i = 0;
    while (i < size) {
        arr[i] = arr[i] + 1;
        i = i + 1;
    }
}

int sumArray(int arr[], int size) {
    int sum;
    int i;

    sum = 0;
    i = 0;

    while (i < size) {
        sum = sum + arr[i];
        i = i + 1;
    }

    return sum;
}

/* ========================================
   RECURSION TESTING
   ======================================== */

int factorial(int n) {
    int result;

    if (n <= 1) {
        result = 1;
    } else {
        result = n * factorial(n - 1);
    }

    return result;
}

int fibonacci(int n) {
    int result;

    if (n <= 1) {
        result = n;
    } else {
        result = fibonacci(n - 1) + fibonacci(n - 2);
    }

    return result;
}

int power(int base, int exp) {
    int result;

    if (exp == 0) {
        result = 1;
    } else {
        result = base * power(base, exp - 1);
    }

    return result;
}

/* ========================================
   GCD ALGORITHM (Euclidean)
   ======================================== */

int gcd(int a, int b) {
    int remainder;

    while (b != 0) {
        remainder = a - (a / b) * b;  /* Modulo operation */
        a = b;
        b = remainder;
    }

    return a;
}

/* ========================================
   ARRAY SEARCHING
   ======================================== */

int linearSearch(int arr[], int size, int target) {
    int i;
    int found;

    i = 0;
    found = -1;

    while (i < size) {
        if (arr[i] == target) {
            found = i;
            i = size;  /* Exit loop */
        } else {
            i = i + 1;
        }
    }

    return found;
}

/* ========================================
   ARRAY SORTING (Bubble Sort)
   ======================================== */

void bubbleSort(int arr[], int size) {
    int i;
    int j;
    int temp;

    i = 0;
    while (i < size - 1) {
        j = 0;
        while (j < size - i - 1) {
            if (arr[j] > arr[j + 1]) {
                /* Swap elements */
                temp = arr[j];
                arr[j] = arr[j + 1];
                arr[j + 1] = temp;
            }
            j = j + 1;
        }
        i = i + 1;
    }
}

/* ========================================
   FINDING MAXIMUM AND MINIMUM
   ======================================== */

int findMax(int arr[], int size) {
    int max;
    int i;

    max = arr[0];
    i = 1;

    while (i < size) {
        if (arr[i] > max) {
            max = arr[i];
        }
        i = i + 1;
    }

    return max;
}

int findMin(int arr[], int size) {
    int min;
    int i;

    min = arr[0];
    i = 1;

    while (i < size) {
        if (arr[i] < min) {
            min = arr[i];
        }
        i = i + 1;
    }

    return min;
}

/* ========================================
   PRIME NUMBER CHECKING
   ======================================== */

int isPrime(int n) {
    int i;
    int result;

    if (n <= 1) {
        result = 0;
    } else {
        result = 1;
        i = 2;

        while (i < n) {
            if (n / i * i == n) {  /* Check if i divides n */
                result = 0;
                i = n;  /* Exit loop */
            } else {
                i = i + 1;
            }
        }
    }

    return result;
}

/* ========================================
   COUNT PRIMES UP TO N
   ======================================== */

int countPrimes(int limit) {
    int count;
    int i;

    count = 0;
    i = 2;

    while (i <= limit) {
        if (isPrime(i) == 1) {
            count = count + 1;
        }
        i = i + 1;
    }

    return count;
}

/* ========================================
   REVERSE ARRAY
   ======================================== */

void reverseArray(int arr[], int size) {
    int left;
    int right;
    int temp;

    left = 0;
    right = size - 1;

    while (left < right) {
        temp = arr[left];
        arr[left] = arr[right];
        arr[right] = temp;

        left = left + 1;
        right = right - 1;
    }
}

/* ========================================
   COMPLEX EXPRESSION TESTING
   ======================================== */

int testComplexExpressions(int a, int b, int c) {
    int result;

    /* Multiple operations with precedence */
    result = a + b * c - a / b;

    /* Nested parentheses */
    result = ((a + b) * (c - a)) / (b + 1);

    /* Long expression */
    result = a * b + c * a - b / c + a - b + c;

    return result;
}

/* ========================================
   VOID FUNCTION TESTING
   ======================================== */

void testVoidFunction(int x) {
    int y;

    y = x * 2;
    print(y);
}

void printArray(int arr[], int size) {
    int i;

    i = 0;
    while (i < size) {
        print(arr[i]);
        i = i + 1;
    }
}

/* ========================================
   MULTIPLE PARAMETERS TESTING
   ======================================== */

int multiply3(int a, int b, int c) {
    return a * b * c;
}

int add4(int a, int b, int c, int d) {
    return a + b + c + d;
}

int max3(int a, int b, int c) {
    int max;

    max = a;

    if (b > max) {
        max = b;
    }

    if (c > max) {
        max = c;
    }

    return max;
}

/* ========================================
   ARRAY MANIPULATION FUNCTIONS
   ======================================== */

void fillArray(int arr[], int size, int value) {
    int i;

    i = 0;
    while (i < size) {
        arr[i] = value;
        i = i + 1;
    }
}

void copyArray(int source[], int dest[], int size) {
    int i;

    i = 0;
    while (i < size) {
        dest[i] = source[i];
        i = i + 1;
    }
}

int arrayEqual(int arr1[], int arr2[], int size) {
    int i;
    int equal;

    equal = 1;
    i = 0;

    while (i < size) {
        if (arr1[i] != arr2[i]) {
            equal = 0;
            i = size;  /* Exit loop */
        } else {
            i = i + 1;
        }
    }

    return equal;
}

/* ========================================
   MATHEMATICAL FUNCTIONS
   ======================================== */

int absoluteValue(int x) {
    int result;

    if (x < 0) {
        result = 0 - x;
    } else {
        result = x;
    }

    return result;
}

int sign(int x) {
    int result;

    if (x < 0) {
        result = -1;
    } else {
        if (x > 0) {
            result = 1;
        } else {
            result = 0;
        }
    }

    return result;
}

/* ========================================
   COUNTING AND ACCUMULATION
   ======================================== */

int sumOfSquares(int n) {
    int sum;
    int i;

    sum = 0;
    i = 1;

    while (i <= n) {
        sum = sum + i * i;
        i = i + 1;
    }

    return sum;
}

int sumOfCubes(int n) {
    int sum;
    int i;

    sum = 0;
    i = 1;

    while (i <= n) {
        sum = sum + i * i * i;
        i = i + 1;
    }

    return sum;
}

/* ========================================
   ARRAY STATISTICS
   ======================================== */

int calculateMean(int arr[], int size) {
    int sum;
    int i;

    sum = 0;
    i = 0;

    while (i < size) {
        sum = sum + arr[i];
        i = i + 1;
    }

    return sum / size;
}

int countOccurrences(int arr[], int size, int value) {
    int count;
    int i;

    count = 0;
    i = 0;

    while (i < size) {
        if (arr[i] == value) {
            count = count + 1;
        }
        i = i + 1;
    }

    return count;
}

/* ========================================
   BINARY OPERATIONS
   ======================================== */

int leftShift(int n, int bits) {
    int result;
    int i;

    result = n;
    i = 0;

    while (i < bits) {
        result = result * 2;
        i = i + 1;
    }

    return result;
}

int rightShift(int n, int bits) {
    int result;
    int i;

    result = n;
    i = 0;

    while (i < bits) {
        result = result / 2;
        i = i + 1;
    }

    return result;
}

/* ========================================
   STRING-LIKE OPERATIONS (using int arrays)
   ======================================== */

int arrayLength(int arr[], int maxSize) {
    int length;

    length = 0;

    while (length < maxSize) {
        if (arr[length] == 0) {
            length = maxSize;  /* Exit loop */
        } else {
            length = length + 1;
        }
    }

    return length;
}

/* ========================================
   MAIN FUNCTION - COMPREHENSIVE TESTING
   ======================================== */

void main(void) {
    int testArray[5];
    int testArray2[5];
    int i;
    int result;
    int a;
    int b;
    int choice;

    /* Initialize smaller local variables instead of large arrays */
    int globalCounter = 0;

    /* Test 1: Arithmetic Operations */
    print("Test 1 - 72");  /* Test marker - Expected output: 1 */
    result = testArithmetic(10, 5);
    print(result);  /* Expected output: 72 (returned is sum+diff+prod+quot=15+5+50+2=72) */

    /* Test 2: Relational Operations */
    print("Test 2 - 100011");  /* Test marker - Expected output: 2 */
    result = testRelational(5, 10);
    print(result);  /* Expected output: 100011 (5<10:+1, 5<=10:+10, 5>10:no, 5>=10:no, 5==10:no, 5!=10:+100000; 1+10+100000=100011) */

    /* Test 3: If-Else Statements */
    print("Test 3 - 50");  /* Test marker - Expected output: 3 */
    result = testIfElse(75);
    print(result);  /* Expected output: 50 (75>0:result=1, 75>=0:result=0, nested: 75<=100 and 75>50:result=50) */

    /* Test 4: While Loops */
    print("Test 4 - 55");  /* Test marker - Expected output: 4 */
    result = testWhileLoop(10);
    print(result);  /* Expected output: 55 (sum of 1+2+3+4+5+6+7+8+9+10) */

    /* Test 5: Nested Loops */
    print("Test 5 - 25");  /* Test marker - Expected output: 5 */
    result = testNestedLoops(5, 5);
    print(result);  /* Expected output: 25 (5 rows × 5 cols = 25 iterations) */

    /* Test 6: Array Operations */
    print("Test 6 - 25");  /* Test marker - Expected output: 6 */
    testArrayOperations(testArray, 5);
    result = sumArray(testArray, 5);
    print(result);  /* Expected output: 25 (testArrayOperations sets arr[i]=i*2+1; sum of 1+3+5+7+9=25) */

    /* Test 7: Factorial (Recursion) */
    print("Test 7 - 120");  /* Test marker - Expected output: 7 */
    result = factorial(5);
    print(result);  /* Expected output: 120 (5! = 5×4×3×2×1) */

    /* Test 8: Fibonacci */
    print("Test 8 - 13");  /* Test marker - Expected output: 8 */
    result = fibonacci(7);
    print(result);  /* Expected output: 13 (fib sequence: 0,1,1,2,3,5,8,13) */

    /* Test 9: Power Function */
    print("Test 9 - 32");  /* Test marker - Expected output: 9 */
    result = power(2, 5);
    print(result);  /* Expected output: 32 (2^5) */

    /* Test 10: GCD */
    print("Test 10 - 6");  /* Test marker - Expected output: 10 */
    result = gcd(48, 18);
    print(result);  /* Expected output: 6 (greatest common divisor of 48 and 18) */

    /* Test 11: Array Search */
    print("Test 11 - 4");  /* Test marker - Expected output: 11 */
    i = 0;
    while (i < 5) {
        testArray[i] = i * 3;
        i = i + 1;
    }
    result = linearSearch(testArray, 5, 12);
    print(result);  /* Expected output: 4 (array is [0,3,6,9,12], 12 is at index 4) */

    /* Test 12: Bubble Sort */
    print("Test 12 - 1 2 5 8 9");  /* Test marker - Expected output: 12 */
    testArray[0] = 5;
    testArray[1] = 2;
    testArray[2] = 8;
    testArray[3] = 1;
    testArray[4] = 9;
    bubbleSort(testArray, 5);
    printArray(testArray, 5);  /* Expected output: 1 2 5 8 9 (sorted array) */

    /* Test 13: Find Max and Min */
    print("Test 13 - 9 1");  /* Test marker - Expected output: 13 */
    result = findMax(testArray, 5);
    print(result);  /* Expected output: 9 (max of sorted array [1,2,5,8,9]) */
    result = findMin(testArray, 5);
    print(result);  /* Expected output: 1 (min of sorted array [1,2,5,8,9]) */

    /* Test 14: Prime Number Testing */
    print("Test 14 - 1 0");  /* Test marker - Expected output: 14 */
    result = isPrime(17);
    print(result);  /* Expected output: 1 (17 is prime) */
    result = isPrime(18);
    print(result);  /* Expected output: 0 (18 is not prime, divisible by 2) */

    /* Test 15: Count Primes */
    print("Test 15 - 8");  /* Test marker - Expected output: 15 */
    result = countPrimes(20);
    print(result);  /* Expected output: 8 (primes ≤20: 2,3,5,7,11,13,17,19) */

    /* Test 16: Reverse Array */
    print("Test 16 - 5 4 3 2 1");  /* Test marker - Expected output: 16 */
    i = 0;
    while (i < 5) {
        testArray[i] = i + 1;
        i = i + 1;
    }
    reverseArray(testArray, 5);
    printArray(testArray, 5);  /* Expected output: 5 4 3 2 1 (reversed from [1,2,3,4,5]) */

    /* Test 17: Multiple Parameters */
    print("Test 17 - 24 10 9");  /* Test marker - Expected output: 17 */
    result = multiply3(2, 3, 4);
    print(result);  /* Expected output: 24 (2×3×4) */
    result = add4(1, 2, 3, 4);
    print(result);  /* Expected output: 10 (1+2+3+4) */
    result = max3(5, 9, 3);
    print(result);  /* Expected output: 9 (max of 5,9,3) */

    /* Test 18: Array Fill and Copy */
    print("Test 18 - 1");  /* Test marker - Expected output: 18 */
    fillArray(testArray, 5, 7);
    copyArray(testArray, testArray2, 5);
    result = arrayEqual(testArray, testArray2, 5);
    print(result);  /* Expected output: 1 (arrays should be equal after copy) */

    /* Test 19: Absolute Value and Sign */
    print("Test 19 - 15 -1 1 0");  /* Test marker - Expected output: 19 */
    result = absoluteValue(-15);
    print(result);  /* Expected output: 15 (absolute value of -15) */
    result = sign(-5);
    print(result);  /* Expected output: -1 (sign of negative number) */
    result = sign(5);
    print(result);  /* Expected output: 1 (sign of positive number) */
    result = sign(0);
    print(result);  /* Expected output: 0 (sign of zero) */

    /* Test 20: Sum of Squares and Cubes */
    print("Test 20 - 55 225");  /* Test marker - Expected output: 20 */
    result = sumOfSquares(5);
    print(result);  /* Expected output: 55 (1²+2²+3²+4²+5² = 1+4+9+16+25) */
    result = sumOfCubes(5);
    print(result);  /* Expected output: 225 (1³+2³+3³+4³+5³ = 1+8+27+64+125) */

    /* Test 21: Array Statistics */
    print("Test 21 - 6 3");  /* Test marker - Expected output: 21 */
    i = 0;
    while (i < 5) {
        testArray[i] = (i + 1) * 2;
        i = i + 1;
    }
    result = calculateMean(testArray, 5);
    print(result);  /* Expected output: 6 (array [2,4,6,8,10], sum=30, mean=30/5=6) */
    testArray[0] = 5;
    testArray[1] = 5;
    testArray[2] = 3;
    testArray[3] = 5;
    testArray[4] = 7;
    result = countOccurrences(testArray, 5, 5);
    print(result);  /* Expected output: 3 (array [5,5,3,5,7] has three 5s) */

    /* Test 22: Bit Shift Operations */
    print("Test 22 - 12 4");  /* Test marker - Expected output: 22 */
    result = leftShift(3, 2);
    print(result);  /* Expected output: 12 (3 << 2 = 3×2×2) */
    result = rightShift(16, 2);
    print(result);  /* Expected output: 4 (16 >> 2 = 16/2/2) */

    /* Test 23: Complex Expressions */
    print("Test 23 - 87");  /* Test marker - Expected output: 23 */
    result = testComplexExpressions(10, 5, 3);
    print(result);  /* Expected output: 87 (final expr with a=10,b=5,c=3: 10*5+3*10-5/3+10-5+3 = 50+30-1+10-5+3 = 87) */

    /* Test 24: Local Variables */
    print("Test 24 - 100 120");  /* Test marker - Expected output: 24 */
    globalCounter = 100;
    print(globalCounter);  /* Expected output: 100 (assigned value) */
    print(globalCounter + 20);  /* Expected output: 120 (100+20) */

    /* Test 25: Void Functions */
    print("Test 25 - 10");  /* Test marker - Expected output: 25 */
    testVoidFunction(5);  /* Expected output: 10 (function prints 5*2) */

    /* All tests complete */
    print(999);  /* Test completion marker - Expected output: 999 */
}
